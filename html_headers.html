<link rel="stylesheet" href="https://unpkg.com/papercss@1.8.3/dist/paper.min.css">

<script>
  function element(tagName, props = {}, style = {}, fn = () => {}) {
    const element = document.createElement(tagName)
		
		Object.entries(props).forEach(([ key, value ]) => element[key] = value)
		Object.entries(style).forEach(([ key, value ]) => element.style[key] = value)

		const result = fn()
		if (result && "style" in result) {
			element.append(result)
			element[result.tagName.toLowerCase()] = result
		} else if (result && Array.isArray(result)) {
			result.forEach(childElement => {
				element.append(childElement)
				element[childElement.tagName.toLowerCase()] = childElement
			})
		} else if (result) {
			Object.entries(result).forEach(([ name, childElement ]) => {
				element.append(childElement)
				element[name] = childElement
			})
		}

		return element
  }

  function register(instance, hash) {
    Object.entries(hash).forEach(([name, element]) => {
      instance.canvas.append(element)
      instance.data[name] = element
    })
  }

  function updateStyle(element, style) {
    console.log(`Updating ${element.name} with ${JSON.stringify(style)}`)

    Object.entries(hash).forEach(([property, value]) => {
      element.style[property] = value
    })
  }
</script>